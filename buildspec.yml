version: 0.2

phases:
  install:
    runtime-versions:
      nodejs: 20     # âœ… Node 20 ì‚¬ìš©
    commands:
      - echo "ğŸ“¦ Installing dependencies..."
      - cd SW-1.201/frontend
      - sudo chown -R ec2-user:ec2-user /home/ec2-user/app || true   # âœ… ì†Œìœ ê¶Œ ë³´ì •
      - npm ci || npm install
      - chmod -R 755 node_modules/.bin || true   # âœ… ì‹¤í–‰ê¶Œí•œ ë¶€ì—¬ (Vite ë“±)

  build:
    commands:
      - echo "ğŸš€ Building React (Vite) app..."
      - echo "VITE_API_BASE_URL=http://capstone-front-back-nlb-5df2d37f3e3da2a2.elb.ap-northeast-2.amazonaws.com:5000" > .env
      - cat .env   # ğŸ‘€ ë””ë²„ê¹…ìš©: ì‹¤ì œ .env ë‚´ìš© í™•ì¸
      - npm run build

  post_build:
    commands:
      - echo "âœ… Build completed successfully!"

artifacts:
  base-directory: SW-1.201/frontend/out
  files:
    - '**/*'
