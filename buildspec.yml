version: 0.2

phases:
  install:
    runtime-versions:
      nodejs: 20   # âœ… Node 20 ì‚¬ìš©
    commands:
      - echo "ğŸ“¦ Installing dependencies..."
      - cd SW-1.201/frontend
      - npm ci || npm install
      - chmod -R 755 node_modules/.bin || true   # âœ… ì‹¤í–‰ ê¶Œí•œ ë¶€ì—¬ (Vite ë“±)

  build:
    commands:
      - echo "ğŸš€ Building React (Vite) app..."
      # âœ… API URL í™˜ê²½ ë³€ìˆ˜ ìƒì„±
      - echo "VITE_API_BASE_URL=http://capstone-front-back-nlb-5df2d37f3e3da2a2.elb.ap-northeast-2.amazonaws.com:5000" > .env
      - cat .env   # ğŸ‘€ ë””ë²„ê¹…ìš© ì¶œë ¥
      - npm run build
      - echo "âœ… Build completed successfully!"

  post_build:
    commands:
      - echo "ğŸ“¦ Packaging deployment artifacts..."
      - ls -al out || echo "âš ï¸ out í´ë”ê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ë¹Œë“œ ì‹¤íŒ¨ ê°€ëŠ¥ì„± í™•ì¸ í•„ìš”!"

artifacts:
  base-directory: SW-1.201/frontend
  files:
    - appspec.yml
    - scripts/**/*
    - out/**/*
    - server.js
  # discard-paths: yes           # ë¹Œë“œ ê²°ê³¼ë¬¼ í¬í•¨
